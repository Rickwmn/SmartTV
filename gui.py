import weather
from gi.repository import Gtk, Gdk, Gio
from sys import argv
from os import system, path
from views import LeftBar
from utils import getCardImg, Action, Movie, getMovies


LEFT_BAR_WIDTH = 300
PLACE_HOLDER = "https://picsum.photos/300/150"
FNAME = "placeholder.png"
TESTMODE = True
TEST_JSON = '''
{"status":"ok","status_message":"Query was successful","data":{"movie_count":531,"limit":7,"page_number":1,"movies":[{"id":8462,"url":"https:\/\/yts.lt\/movie\/avengers-infinity-war-2018","imdb_code":"tt4154756","title":"Avengers: Infinity War","title_english":"Avengers: Infinity War","title_long":"Avengers: Infinity War (2018)","slug":"avengers-infinity-war-2018","year":2018,"rating":8.5,"runtime":149,"genres":["Action","Adventure","Drama","Fantasy","Sci-Fi"],"summary":"As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos. A despot of intergalactic infamy, his goal is to collect all six Infinity Stones, artifacts of unimaginable power, and use them to inflict his twisted will on all of reality. Everything the Avengers have fought for has led up to this moment, the fate of Earth and existence has never been more uncertain.","description_full":"As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos. A despot of intergalactic infamy, his goal is to collect all six Infinity Stones, artifacts of unimaginable power, and use them to inflict his twisted will on all of reality. Everything the Avengers have fought for has led up to this moment, the fate of Earth and existence has never been more uncertain.","synopsis":"As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos. A despot of intergalactic infamy, his goal is to collect all six Infinity Stones, artifacts of unimaginable power, and use them to inflict his twisted will on all of reality. Everything the Avengers have fought for has led up to this moment, the fate of Earth and existence has never been more uncertain.","yt_trailer_code":"6ZfuNTqbHE8","language":"English","mpa_rating":"PG-13","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/avengers_infinity_war_2018\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/avengers_infinity_war_2018\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/avengers_infinity_war_2018\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/avengers_infinity_war_2018\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/avengers_infinity_war_2018\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/16B087DFF9C8153072BD35C1BEC245CB831AEF4D","hash":"16B087DFF9C8153072BD35C1BEC245CB831AEF4D","quality":"3D","type":"bluray","seeds":164,"peers":19,"size":"2.39 GB","size_bytes":2566242959,"date_uploaded":"2018-08-18 18:46:19","date_uploaded_unix":1534610779},{"url":"https:\/\/yts.lt\/torrent\/download\/EA17E6BE92962A403AC1C638D2537DCF1E564D26","hash":"EA17E6BE92962A403AC1C638D2537DCF1E564D26","quality":"720p","type":"bluray","seeds":1930,"peers":88,"size":"1.25 GB","size_bytes":1342177280,"date_uploaded":"2018-08-01 07:28:54","date_uploaded_unix":1533101334},{"url":"https:\/\/yts.lt\/torrent\/download\/866BDCFA006930A718ADBC21D8CAE1F2C7F9D8B3","hash":"866BDCFA006930A718ADBC21D8CAE1F2C7F9D8B3","quality":"1080p","type":"bluray","seeds":1957,"peers":80,"size":"2.39 GB","size_bytes":2566242959,"date_uploaded":"2018-08-01 09:57:07","date_uploaded_unix":1533110227},{"url":"https:\/\/yts.lt\/torrent\/download\/BCEB706EA32EDD855FCA4426DF8A7831F53CC3EE","hash":"BCEB706EA32EDD855FCA4426DF8A7831F53CC3EE","quality":"720p","type":"web","seeds":696,"peers":79,"size":"1.24 GB","size_bytes":1331439862,"date_uploaded":"2018-07-30 23:20:59","date_uploaded_unix":1532985659},{"url":"https:\/\/yts.lt\/torrent\/download\/7643D0625DED0A5FC967B37A9D6AF6990236C180","hash":"7643D0625DED0A5FC967B37A9D6AF6990236C180","quality":"1080p","type":"web","seeds":3466,"peers":202,"size":"2.39 GB","size_bytes":2566242959,"date_uploaded":"2018-07-31 01:43:45","date_uploaded_unix":1532994225}],"date_uploaded":"2018-07-30 23:20:59","date_uploaded_unix":1532985659},{"id":5315,"url":"https:\/\/yts.lt\/movie\/star-wars-episode-vii-the-force-awakens-2015","imdb_code":"tt2488496","title":"Star Wars: Episode VII - The Force Awakens","title_english":"Star Wars: Episode VII - The Force Awakens","title_long":"Star Wars: Episode VII - The Force Awakens (2015)","slug":"star-wars-episode-vii-the-force-awakens-2015","year":2015,"rating":8,"runtime":136,"genres":["Action","Adventure","Fantasy","Sci-Fi","Thriller"],"summary":"30 years after the defeat of Darth Vader and the Empire, Rey, a scavenger from the planet Jakku, finds a BB-8 droid that knows the whereabouts of the long lost Luke Skywalker. Rey, as well as a rogue stormtrooper and two smugglers, are thrown into the middle of a battle between the Resistance and the daunting legions of the First Order.","description_full":"30 years after the defeat of Darth Vader and the Empire, Rey, a scavenger from the planet Jakku, finds a BB-8 droid that knows the whereabouts of the long lost Luke Skywalker. Rey, as well as a rogue stormtrooper and two smugglers, are thrown into the middle of a battle between the Resistance and the daunting legions of the First Order.","synopsis":"30 years after the defeat of Darth Vader and the Empire, Rey, a scavenger from the planet Jakku, finds a BB-8 droid that knows the whereabouts of the long lost Luke Skywalker. Rey, as well as a rogue stormtrooper and two smugglers, are thrown into the middle of a battle between the Resistance and the daunting legions of the First Order.","yt_trailer_code":"mMDgTt4kLdo","language":"English","mpa_rating":"PG-13","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/star_wars_episode_vii_the_force_awakens_2015\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/star_wars_episode_vii_the_force_awakens_2015\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/star_wars_episode_vii_the_force_awakens_2015\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/star_wars_episode_vii_the_force_awakens_2015\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/star_wars_episode_vii_the_force_awakens_2015\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/A0165676483620E236789E6D815A9F90492D0867","hash":"A0165676483620E236789E6D815A9F90492D0867","quality":"3D","type":"bluray","seeds":12,"peers":7,"size":"2.11 GB","size_bytes":2265595249,"date_uploaded":"2017-03-18 19:29:44","date_uploaded_unix":1489861784},{"url":"https:\/\/yts.lt\/torrent\/download\/6D33001DD61BE4032AA73D0A193510AE7C4B4DCD","hash":"6D33001DD61BE4032AA73D0A193510AE7C4B4DCD","quality":"720p","type":"bluray","seeds":98,"peers":11,"size":"1022.56 MB","size_bytes":1072231875,"date_uploaded":"2016-03-23 12:20:17","date_uploaded_unix":1458732017},{"url":"https:\/\/yts.lt\/torrent\/download\/423EED0C53F3857F66FCFB7522FB8C3829D1DCF4","hash":"423EED0C53F3857F66FCFB7522FB8C3829D1DCF4","quality":"1080p","type":"bluray","seeds":172,"peers":15,"size":"2.11 GB","size_bytes":2265595249,"date_uploaded":"2016-03-23 16:57:59","date_uploaded_unix":1458748679}],"date_uploaded":"2016-03-23 12:20:17","date_uploaded_unix":1458732017},{"id":5385,"url":"https:\/\/yts.lt\/movie\/the-revenant-2015","imdb_code":"tt1663202","title":"The Revenant","title_english":"The Revenant","title_long":"The Revenant (2015)","slug":"the-revenant-2015","year":2015,"rating":8,"runtime":156,"genres":["Action","Adventure","Biography","Drama","History","Thriller","Western"],"summary":"While exploring uncharted wilderness in 1823, legendary frontiersman Hugh Glass sustains injuries from a brutal bear attack. When his hunting team leaves him for dead, Glass must utilize his survival skills to find a way back home while avoiding natives on their own hunt. Grief-stricken and fueled by vengeance, Glass treks through the wintry terrain to track down John Fitzgerald, the former confidant who betrayed and abandoned him.","description_full":"While exploring uncharted wilderness in 1823, legendary frontiersman Hugh Glass sustains injuries from a brutal bear attack. When his hunting team leaves him for dead, Glass must utilize his survival skills to find a way back home while avoiding natives on their own hunt. Grief-stricken and fueled by vengeance, Glass treks through the wintry terrain to track down John Fitzgerald, the former confidant who betrayed and abandoned him.","synopsis":"While exploring uncharted wilderness in 1823, legendary frontiersman Hugh Glass sustains injuries from a brutal bear attack. When his hunting team leaves him for dead, Glass must utilize his survival skills to find a way back home while avoiding natives on their own hunt. Grief-stricken and fueled by vengeance, Glass treks through the wintry terrain to track down John Fitzgerald, the former confidant who betrayed and abandoned him.","yt_trailer_code":"QRfj1VCg16Y","language":"English","mpa_rating":"R","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/the_revenant_2015\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/the_revenant_2015\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/the_revenant_2015\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/the_revenant_2015\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/the_revenant_2015\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/CBD21C97A839851A53CF1230E968FF373FE9A63E","hash":"CBD21C97A839851A53CF1230E968FF373FE9A63E","quality":"720p","type":"bluray","seeds":201,"peers":27,"size":"1.13 GB","size_bytes":1213328261,"date_uploaded":"2016-04-09 18:37:27","date_uploaded_unix":1460219847},{"url":"https:\/\/yts.lt\/torrent\/download\/931A5BC5CE3767168D00F92A2E4CFFE472B9CE54","hash":"931A5BC5CE3767168D00F92A2E4CFFE472B9CE54","quality":"1080p","type":"bluray","seeds":201,"peers":16,"size":"2.39 GB","size_bytes":2566242959,"date_uploaded":"2016-04-09 23:01:30","date_uploaded_unix":1460235690}],"date_uploaded":"2016-04-09 18:37:27","date_uploaded_unix":1460219847},{"id":6507,"url":"https:\/\/yts.lt\/movie\/logan-2017","imdb_code":"tt3315342","title":"Logan","title_english":"Logan","title_long":"Logan (2017)","slug":"logan-2017","year":2017,"rating":8.1,"runtime":137,"genres":["Action","Drama","Sci-Fi","Thriller"],"summary":"In 2029 the mutant population has shrunken significantly due to genetically modified plants designed to reduce mutant powers and the X-Men have disbanded. Logan, whose power to self-heal is dwindling, has surrendered himself to alcohol and now earns a living as a chauffeur. He takes care of the ailing old Professor X whom he keeps hidden away. One day, a female stranger asks Logan to drive a girl named Laura to the Canadian border. At first he refuses, but the Professor has been waiting for a long time for her to appear. Laura possesses an extraordinary fighting prowess and is in many ways like Wolverine. She is pursued by sinister figures working for a powerful corporation; this is because they made her, with Logan's DNA. A decrepit Logan is forced to ask himself if he can or even wants to put his remaining powers to good use. It would appear that in the near-future, the times in which they were able put the world to rights with razor sharp claws and telepathic powers are now over.","description_full":"In 2029 the mutant population has shrunken significantly due to genetically modified plants designed to reduce mutant powers and the X-Men have disbanded. Logan, whose power to self-heal is dwindling, has surrendered himself to alcohol and now earns a living as a chauffeur. He takes care of the ailing old Professor X whom he keeps hidden away. One day, a female stranger asks Logan to drive a girl named Laura to the Canadian border. At first he refuses, but the Professor has been waiting for a long time for her to appear. Laura possesses an extraordinary fighting prowess and is in many ways like Wolverine. She is pursued by sinister figures working for a powerful corporation; this is because they made her, with Logan's DNA. A decrepit Logan is forced to ask himself if he can or even wants to put his remaining powers to good use. It would appear that in the near-future, the times in which they were able put the world to rights with razor sharp claws and telepathic powers are now over.","synopsis":"In 2029 the mutant population has shrunken significantly due to genetically modified plants designed to reduce mutant powers and the X-Men have disbanded. Logan, whose power to self-heal is dwindling, has surrendered himself to alcohol and now earns a living as a chauffeur. He takes care of the ailing old Professor X whom he keeps hidden away. One day, a female stranger asks Logan to drive a girl named Laura to the Canadian border. At first he refuses, but the Professor has been waiting for a long time for her to appear. Laura possesses an extraordinary fighting prowess and is in many ways like Wolverine. She is pursued by sinister figures working for a powerful corporation; this is because they made her, with Logan's DNA. A decrepit Logan is forced to ask himself if he can or even wants to put his remaining powers to good use. It would appear that in the near-future, the times in which they were able put the world to rights with razor sharp claws and telepathic powers are now over.","yt_trailer_code":"Div0iP65aZo","language":"English","mpa_rating":"R","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/logan_2017\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/logan_2017\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/logan_2017\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/logan_2017\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/logan_2017\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/A52324E4506C66CB30067BE13EE366C225BC4D70","hash":"A52324E4506C66CB30067BE13EE366C225BC4D70","quality":"720p","type":"bluray","seeds":388,"peers":56,"size":"1014.33 MB","size_bytes":1063602094,"date_uploaded":"2017-05-22 04:27:42","date_uploaded_unix":1495420062},{"url":"https:\/\/yts.lt\/torrent\/download\/1AB2CE4D62A9A46E91A3A3097BCEBD6248978D40","hash":"1AB2CE4D62A9A46E91A3A3097BCEBD6248978D40","quality":"1080p","type":"bluray","seeds":469,"peers":83,"size":"2.09 GB","size_bytes":2244120412,"date_uploaded":"2017-05-22 06:55:05","date_uploaded_unix":1495428905}],"date_uploaded":"2017-05-22 04:27:42","date_uploaded_unix":1495420062},{"id":5512,"url":"https:\/\/yts.lt\/movie\/deadpool-2016","imdb_code":"tt1431045","title":"Deadpool","title_english":"Deadpool","title_long":"Deadpool (2016)","slug":"deadpool-2016","year":2016,"rating":8,"runtime":108,"genres":["Action","Adventure","Comedy","Romance","Sci-Fi"],"summary":"This is the origin story of former Special Forces operative turned mercenary Wade Wilson, who after being subjected to a rogue experiment that leaves him with accelerated healing powers, adopts the alter ego Deadpool. Armed with his new abilities and a dark, twisted sense of humor, Deadpool hunts down the man who nearly destroyed his life.","description_full":"This is the origin story of former Special Forces operative turned mercenary Wade Wilson, who after being subjected to a rogue experiment that leaves him with accelerated healing powers, adopts the alter ego Deadpool. Armed with his new abilities and a dark, twisted sense of humor, Deadpool hunts down the man who nearly destroyed his life.","synopsis":"This is the origin story of former Special Forces operative turned mercenary Wade Wilson, who after being subjected to a rogue experiment that leaves him with accelerated healing powers, adopts the alter ego Deadpool. Armed with his new abilities and a dark, twisted sense of humor, Deadpool hunts down the man who nearly destroyed his life.","yt_trailer_code":"FyKWUTwSYAs","language":"English","mpa_rating":"R","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/deadpool_2016\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/deadpool_2016\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/deadpool_2016\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/deadpool_2016\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/deadpool_2016\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/A1D0C3B0FD52A29D2487027E6B50F27EAF4912C5","hash":"A1D0C3B0FD52A29D2487027E6B50F27EAF4912C5","quality":"720p","type":"bluray","seeds":393,"peers":34,"size":"798.59 MB","size_bytes":837382308,"date_uploaded":"2016-04-27 11:45:25","date_uploaded_unix":1461750325},{"url":"https:\/\/yts.lt\/torrent\/download\/6268ABCCB049444BEE76813177AA46643A7ADA88","hash":"6268ABCCB049444BEE76813177AA46643A7ADA88","quality":"1080p","type":"bluray","seeds":440,"peers":40,"size":"1.65 GB","size_bytes":1771674010,"date_uploaded":"2016-04-27 14:49:31","date_uploaded_unix":1461761371}],"date_uploaded":"2016-04-27 11:45:25","date_uploaded_unix":1461750325},{"id":1632,"url":"https:\/\/yts.lt\/movie\/interstellar-2014","imdb_code":"tt0816692","title":"Interstellar","title_english":"Interstellar","title_long":"Interstellar (2014)","slug":"interstellar-2014","year":2014,"rating":8.6,"runtime":169,"genres":["Action","Adventure","Drama","Sci-Fi"],"summary":"Earth's future has been riddled by disasters, famines, and droughts. There is only one way to ensure mankind's survival: Interstellar travel. A newly discovered wormhole in the far reaches of our solar system allows a team of astronauts to go where no man has gone before, a planet that may have the right environment to sustain human life.","description_full":"Earth's future has been riddled by disasters, famines, and droughts. There is only one way to ensure mankind's survival: Interstellar travel. A newly discovered wormhole in the far reaches of our solar system allows a team of astronauts to go where no man has gone before, a planet that may have the right environment to sustain human life.","synopsis":"Earth's future has been riddled by disasters, famines, and droughts. There is only one way to ensure mankind's survival: Interstellar travel. A newly discovered wormhole in the far reaches of our solar system allows a team of astronauts to go where no man has gone before, a planet that may have the right environment to sustain human life.","yt_trailer_code":"2LqzF5WauAw","language":"English","mpa_rating":"PG-13","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/interstellar_2014\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/interstellar_2014\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/interstellar_2014\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/interstellar_2014\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/interstellar_2014\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/6E88B3F25BA49D483D740A652BF013C341BC5373","hash":"6E88B3F25BA49D483D740A652BF013C341BC5373","quality":"720p","type":"bluray","seeds":493,"peers":32,"size":"1.02 GB","size_bytes":1095216660,"date_uploaded":"2015-11-01 00:18:06","date_uploaded_unix":1446333486},{"url":"https:\/\/yts.lt\/torrent\/download\/89599BF4DC369A3A8ECA26411C5CCF922D78B486","hash":"89599BF4DC369A3A8ECA26411C5CCF922D78B486","quality":"1080p","type":"bluray","seeds":1082,"peers":63,"size":"2.26 GB","size_bytes":2426656522,"date_uploaded":"2015-11-01 00:18:07","date_uploaded_unix":1446333487}],"date_uploaded":"2015-11-01 00:18:06","date_uploaded_unix":1446333486},{"id":10960,"url":"https:\/\/yts.lt\/movie\/spider-man-into-the-spider-verse-2018","imdb_code":"tt4633694","title":"Spider-Man: Into the Spider-Verse","title_english":"Spider-Man: Into the Spider-Verse","title_long":"Spider-Man: Into the Spider-Verse (2018)","slug":"spider-man-into-the-spider-verse-2018","year":2018,"rating":8.5,"runtime":117,"genres":["Action","Adventure","Animation","Family","Sci-Fi"],"summary":"Miles Morales is a New York teen struggling with school, friends and, on top of that, being the new Spider-Man. When he comes across Peter Parker, the erstwhile saviour of New York, in the multiverse, Miles must train to become the new protector of his city.","description_full":"Miles Morales is a New York teen struggling with school, friends and, on top of that, being the new Spider-Man. When he comes across Peter Parker, the erstwhile saviour of New York, in the multiverse, Miles must train to become the new protector of his city.","synopsis":"Miles Morales is a New York teen struggling with school, friends and, on top of that, being the new Spider-Man. When he comes across Peter Parker, the erstwhile saviour of New York, in the multiverse, Miles must train to become the new protector of his city.","yt_trailer_code":"g4Hbz2jLxvQ","language":"English","mpa_rating":"PG","background_image":"https:\/\/yts.lt\/assets\/images\/movies\/spider_man_into_the_spider_verse_2018\/background.jpg","background_image_original":"https:\/\/yts.lt\/assets\/images\/movies\/spider_man_into_the_spider_verse_2018\/background.jpg","small_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/spider_man_into_the_spider_verse_2018\/small-cover.jpg","medium_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/spider_man_into_the_spider_verse_2018\/medium-cover.jpg","large_cover_image":"https:\/\/yts.lt\/assets\/images\/movies\/spider_man_into_the_spider_verse_2018\/large-cover.jpg","state":"ok","torrents":[{"url":"https:\/\/yts.lt\/torrent\/download\/D5D7DC9374B6E2F7C26B024A85DD180F7EC3E131","hash":"D5D7DC9374B6E2F7C26B024A85DD180F7EC3E131","quality":"3D","type":"bluray","seeds":66,"peers":13,"size":"1.87 GB","size_bytes":2007897211,"date_uploaded":"2019-03-17 02:38:17","date_uploaded_unix":1552786697},{"url":"https:\/\/yts.lt\/torrent\/download\/44C2FAC39605DB697C045D0EB664C9E4B7D1F95B","hash":"44C2FAC39605DB697C045D0EB664C9E4B7D1F95B","quality":"720p","type":"bluray","seeds":708,"peers":98,"size":"1003.51 MB","size_bytes":1052256502,"date_uploaded":"2019-03-08 18:34:42","date_uploaded_unix":1552066482},{"url":"https:\/\/yts.lt\/torrent\/download\/EADF812FFF1D9F1200AA87AB93DAEE6B40F96C33","hash":"EADF812FFF1D9F1200AA87AB93DAEE6B40F96C33","quality":"1080p","type":"bluray","seeds":960,"peers":43,"size":"1.88 GB","size_bytes":2018634629,"date_uploaded":"2019-03-08 20:15:33","date_uploaded_unix":1552072533},{"url":"https:\/\/yts.lt\/torrent\/download\/E70B6A744044DD0CAAA33335F4B620DBC47018CB","hash":"E70B6A744044DD0CAAA33335F4B620DBC47018CB","quality":"720p","type":"web","seeds":1265,"peers":84,"size":"995.38 MB","size_bytes":1043731579,"date_uploaded":"2019-02-20 05:47:56","date_uploaded_unix":1550638076},{"url":"https:\/\/yts.lt\/torrent\/download\/A753EA13F243EF9C4006D103DCBDBC7CABAD8A01","hash":"A753EA13F243EF9C4006D103DCBDBC7CABAD8A01","quality":"1080p","type":"web","seeds":1959,"peers":105,"size":"1.87 GB","size_bytes":2007897211,"date_uploaded":"2019-02-20 07:28:44","date_uploaded_unix":1550644124}],"date_uploaded":"2019-02-20 05:47:56","date_uploaded_unix":1550638076}]},"@meta":{"server_time":1561568973,"server_timezone":"CET","api_version":2,"execution_time":"0.02 ms"}}
'''

if len(argv) > 1:
    TESTMODE = bool(int(argv[1]))


class WeatherBox(Gtk.Grid):
    def __init__(self):
        Gtk.Grid.__init__(self)
        curWeather = weather.Weather(testMode=TESTMODE)
        condition = curWeather.iconCode
        conditions = {"01d": "weather-clear",
                      "02d": "weather-few-clouds",
                      "03d": "weather-overcast",
                      "04d": "weather-overcast",
                      "09d": "weather-showers",
                      "10d": "weather-showers-scattered",
                      "11d": "weather-storm",
                      "13d": "weather-snow",
                      "50d": "weather-fog",
                      "01n": "weather-clear-night",
                      "02n": "weather-few-clouds-night",
                      "03n": "weather-overcast",
                      "04n": "weather-overcast",
                      "09n": "weather-showers",
                      "10n": "weather-showers-scattered",
                      "11n": "weather-storm",
                      "13n": "weather-snow",
                      "50n": "weather-fog"}
        icon = Gio.ThemedIcon(name=conditions[condition])
        image = Gtk.Image.new_from_gicon(icon, 6)
        image.set_pixel_size(LEFT_BAR_WIDTH-4)
        image.set_halign(Gtk.Align.CENTER)
        self.add(image)
        label = Gtk.Label()
        label.set_markup(
            '<big><big><big><b>{}</b></big></big></big>'.format(str(curWeather.temperature)+"Â°C"))
        self.attach(label, 0, 1, 1, 1)


class AppItem(Gtk.Box):
    def __init__(self, name, image, width=300, heigth=150):
        Gtk.Box.__init__(self, spacing=2, orientation=Gtk.Orientation.VERTICAL)
        self.pack_end(Gtk.Label(label=name), False, False, 0)
        self.pack_start(getCardImg(
            url=image, fname=FNAME, testMode=TESTMODE, width=width, heigth=heigth), False, False, 0)


class Category(Gtk.Box):
    def __init__(self, category, items, width=300, heigth=150):
        Gtk.Box.__init__(
            self, orientation=Gtk.Orientation.VERTICAL, spacing=2)
        self.title = Gtk.Label(label=category)
        self.title.set_halign(Gtk.Align.START)
        self.pack_start(self.title, False, False, 10)
        self.view = Gtk.ScrolledWindow()
        self.view.set_policy(Gtk.PolicyType.AUTOMATIC,
                             Gtk.PolicyType.NEVER)
        self.pack_end(self.view, True, True, 0)
        self.flowbox = Gtk.FlowBox(
            orientation=Gtk.Orientation.HORIZONTAL)
        self.flowbox.set_min_children_per_line(7)
        self.flowbox.set_homogeneous(True)

        for i, j in enumerate(items):
            self.flowbox.insert(
                AppItem(j.getTitle, j.getCovers[1], width=width, heigth=heigth), i+1)
        self.view.add(self.flowbox)


class MainBar(Gtk.ScrolledWindow):
    def __init__(self):
        Gtk.ScrolledWindow.__init__(self)
        categories = {
            "      Top Movies": getMovies(TEST_JSON),
        }
        self.set_policy(
            Gtk.PolicyType.NEVER, Gtk.PolicyType.AUTOMATIC)
        self.listview = Gtk.ListBox()
        self.listview.set_selection_mode(0)
        for i, j in enumerate(categories.keys()):
            self.listview.insert(
                Category(j, categories[j], 230, 345), i+1)
        self.add(self.listview)


class MainWindow(Gtk.Window):
    def __init__(self):
        left_bar_actions = [
            Action("Main", "go-home", lambda:0),
            Action("Apps", "view-grid", lambda: 0),
            Action("Files", "folder", lambda: 0),
            Action("Settings", "open-menu",
                   lambda: system("python3 " + path.abspath("settings.py"))),
        ]
        Gtk.Window.__init__(self, title="SmartTV OpenSource")
        self.set_default_size(Gdk.Screen.get_default().get_width(),
                              Gdk.Screen.get_default().get_height())
        self.main_divider = Gtk.Box(spacing=6)
        self.add(self.main_divider)
        self.leftbar = LeftBar(
            actions=left_bar_actions, left_bar_width=LEFT_BAR_WIDTH, start_index=0)
        self.leftbar.listview.insert(WeatherBox(), 0)
        self.main_divider.pack_start(self.leftbar, False, True, 0)
        self.main_divider.pack_end(MainBar(), True, True, 0)


window = MainWindow()
window.fullscreen()
window.connect("destroy", Gtk.main_quit)
window.show_all()
Gtk.main()
